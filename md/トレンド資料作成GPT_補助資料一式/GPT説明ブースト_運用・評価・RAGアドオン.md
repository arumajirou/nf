# GPT説明能力ブースト ─ 運用・評価・RAGアドオン（実装手引き）
バージョン: 1.0 / 作成日: 2025-11-07

本資料は、既存の「拡張版ガイド」「追加手法パック」に **運用設計・自動評価・知識の取り込み（RAG）** を重ね、現場で壊れにくい説明生成を実現するための**実装寄り手引き**です。

---

## 0. ねらい（何が良くなるか）
- **一貫性**：毎回同品質の説明（三層構造・SCQA・図・テスト）が揃う
- **堅牢性**：Mermaid崩れ・ID衝突・音声NG・印刷NGを回避
- **正確性**：数値・単位・母数・ベースレート・因果/相関を機械的に点検
- **改善容易性**：A/B・評価ログにより継続改善
- **拡張性**：RAGで社内/領域知識を安全に注入

---

## 1. アーキテクチャ（RAG＋プロンプト運用）
### 1.1 シンプルRAGパターン（段階的）
1) **ナレッジ作成**：用語カード／誤概念ライブラリ／比喩対応表／FAQ（Q→A→根拠）
2) **分割**：チャンク（400–800字）＋見出し＋出典URL/社内参照キー
3) **検索**：トピック・対象者・制約のクエリを生成→Top-kで取得（k=6±2）
4) **統合**：三層構造の**各節**に割り当て（TL;DR→5分→詳細）
5) **出力**：ガイド準拠テンプレに流し込み

### 1.2 セキュア知識取り込み
- **出典明記**（社内ノート名/版/日付）
- **時刻スタンプ**（知識の賞味期限をメタデータで管理）
- **公開/非公開タグ**で出力可否を制御

### 1.3 失敗しないプロンプト流れ（PACER）
- **P**lan：TL;DRとSCQAの骨子を先に生成  
- **A**lign：対象・制約・評価軸（ルーブリック）を明記  
- **C**reate：5種図＋10項目＋物語を生成  
- **E**valuate：自己点検チェックリストで合否判定  
- **R**evise：不足・違反箇所を修正→再出力

---

## 2. 知識整備（カード設計）
### 2.1 用語カード（7項目）
- 定義 / 用途 / 似た語との違い / 測り方 / 限界 / 例 / 反例

### 2.2 誤概念カード
- 誤概念→なぜ起きる→正しい理解→図例→再発防止フレーズ

### 2.3 比喩ペア表
- 源領域 vs 目標領域：**部品・関係・制約**の対応＋破綻点

---

## 3. 出力プロトコル（壊れない型）
- **見出し＝主張の文**、1セクション＝1メッセージ
- **直接ラベル**、凡例は補助。強調は**一図1点**。
- **数字の三点セット**：単位・母数・比較基準
- **反例学習**：正例と**対**で提示
- **仮定の明示**：不足が残る場合は「仮定：…」と明示

---

## 4. Mermaid堅牢化・リンタ
### 4.1 ID設計
- **接頭辞方式**：図種接頭辞（`fc_`, `sq_`, `st_`, `jn_`, `tl_`, `gg_`…）+日本語ラベル
- **長さ**：8–24文字程度、ASCII英数と`_`のみ

### 4.2 禁止文字リンタ規則（正規表現案）
- 許容：`^[A-Za-z][A-Za-z0-9_]*$`（ID）
- 禁止：絵文字 / `& | # { } [ ] < > \` / 引用符 / 比較記号 / 数字開始

### 4.3 フォールバック
- Mermaid失敗時：表形式の擬似図／箇条書き手順を自動併記

---

## 5. 音声・モバイル・印刷 最適化
- **音声**：略語は（英語/日本語/かみ砕き）併記、記号語回避、読点は短めに
- **モバイル**：表は縦積み、見出し短文、リンク≤3
- **印刷**：白黒で読めるよう線種・形状・直接ラベル

---

## 6. 認知負荷の簡易計測（CLスコア）
- 尺度候補：1スライド要素≤7、WPM 140±20、図の注釈≤7、未知用語≤3/節
- **CL=（未知用語×2）＋（要素数-7）＋（注釈数-7）** を目安に0以下を合格

---

## 7. 数値・因果の安全策
- **単位・母数・基準**の三点セットを自動検出
- **相関≠因果**の注意書きをテンプレで常備
- 図の**ゼロ起点**と**対数軸注記**の監査

---

## 8. A/Bテスト設計（軽量）
- 目標：完了率・正答率・読了時間・再訪率
- **最小効果**の見積もり（例：正答率+8pt）
- 期間は短期（n≥30/版）→効果が見えたら恒久化

---

## 9. 自動評価スイート（JSON検査）
- 必須節の有無、図の個数、Mermaid禁止記号、数値三点セット、自己採点の有無を機械検査
- 付属の **`explainer_check.schema.json`** に従いOK/NGを出す

---

## 10. データ作成（自己対話・転移）
- **自己対話**：モデルに「反論役」をつけて誤概念を露出→修正稿
- **転移テスト**：医療/金融/日常の3領域へ問題を移すセクションを常設

---

## 11. 運用Runbook（よくある事故 → 処置）
- Mermaid崩れ → リンタ→接頭辞再付与→擬似図フォールバック併記
- 音声で読めない → 記号語→日本語置換、ルビ状のかみ砕き追記
- 数値の出典なし → 「仮定」と明示、比較基準を内部一貫に修正

---

## 12. 付録：実務テンプレ集
### 12.1 自己点検プロンプト
```
次の出力を自己点検：図≥5、各図10＋物語、直接ラベル、数値三点セット、反例・限界、テスト30、HTML。違反箇所を列挙→即修正稿を提示。
```

### 12.2 Mermaid最小骨格（安全版）
- flowchart / sequence / state / journey / timeline の最小例（前アドオン参照）

### 12.3 A/Bログ項目
- 版ID、日時、対象、制約、完了率、正答率、読了時間、離脱位置、自由記述

---

## 13. 同梱ファイル
- **explainer_check.schema.json** … 機械検査用スキーマ
- **quiz_bank_template.csv** … 30問構成のテンプレート（UTF-8）

このアドオンを既存の資料群の**最後に追加**してください。設定がそのままチェックリスト兼運用Runbookになります。